---
title: "Make training set fam files for gemma"
author: "Frederick Boehm"
date: "1/14/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Goal

Our goal here is to create a fam file that contains trait values for the 
training set subjects and NAs for the test set subjects. We'll read an existing 
fam file - one that has trait values for all subjects - and replace the trait
values with NAs for those subjects in the test set.

Initially, we'll write a fam file with the name 'chr1.fam' for use with the 
genotypic data files for Chr 1 of the UKB data.

```{r}
fam <- readr::read_delim("~/research/ukb-intervals/dat/plink_files/ukb/chr1.fam", col_names = FALSE)
training_indices <- 1 + readr::read_table("~/research/ukb-intervals/Rmd/training_indices.txt", 
                                          col_names = FALSE) 
# training_indices is written for C++ based indexing, so we add 1 to every entry here!
fam[!(1:nrow(fam) %in% training_indices$X1), 6:ncol(fam)] <- NA
readr::write_delim(x = fam, 
                   file = "~/research/ukb-intervals/dat/plink_files/ukb-gemma-training/chr1.fam", 
                   quote = "none",
                   col_names = FALSE)
```

